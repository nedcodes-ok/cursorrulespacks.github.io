<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rule Playground — Check your Cursor rules instantly | nedcodes</title>
  <meta name="description" content="Paste a .mdc rule file and get instant feedback. Find broken frontmatter, vague instructions, missing fields, and prompt engineering issues.">
  <meta property="og:title" content="Rule Playground — Check your Cursor rules instantly">
  <meta property="og:description" content="Paste a .mdc rule and get instant lint feedback. No install needed.">
  <meta property="og:image" content="https://nedcodes.dev/images/og-card.png">
  <meta property="og:url" content="https://nedcodes.dev/playground">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="theme-color" content="#0a0a0a">
  <link rel="canonical" href="https://nedcodes.dev/playground">
  <link rel="icon" href="/images/favicon.png" type="image/png">
  <link rel="stylesheet" href="/styles.css">
  <style>
    .playground { padding: 100px 0 80px; }
    .playground h1 { font-size: 32px; font-weight: 700; letter-spacing: -0.02em; margin-bottom: 8px; }
    .playground .sub { color: var(--text-muted); margin-bottom: 32px; font-size: 16px; }
    .playground-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }
    .editor-pane, .results-pane { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-lg); overflow: hidden; }
    .pane-header { padding: 12px 16px; border-bottom: 1px solid var(--border); font-size: 13px; font-weight: 600; color: var(--text-muted); display: flex; align-items: center; justify-content: space-between; }
    .pane-header .file-hint { font-weight: 400; font-size: 12px; }
    #editor { width: 100%; min-height: 400px; background: transparent; border: none; color: var(--text); font-family: 'SF Mono', 'Fira Code', Consolas, monospace; font-size: 14px; line-height: 1.6; padding: 16px; resize: vertical; outline: none; }
    .results-body { padding: 16px; min-height: 400px; overflow-y: auto; }
    .result-item { padding: 10px 12px; border-radius: 6px; margin-bottom: 8px; font-size: 13px; line-height: 1.5; }
    .result-error { background: rgba(239, 68, 68, 0.1); border-left: 3px solid #ef4444; }
    .result-warning { background: rgba(245, 158, 11, 0.1); border-left: 3px solid #f59e0b; }
    .result-info { background: rgba(59, 130, 246, 0.1); border-left: 3px solid #3b82f6; }
    .result-ok { background: rgba(34, 197, 94, 0.1); border-left: 3px solid #22c55e; }
    .result-severity { font-weight: 600; text-transform: uppercase; font-size: 11px; letter-spacing: 0.05em; margin-right: 8px; }
    .result-error .result-severity { color: #ef4444; }
    .result-warning .result-severity { color: #f59e0b; }
    .result-info .result-severity { color: #3b82f6; }
    .result-ok .result-severity { color: #22c55e; }
    .result-hint { color: var(--text-muted); font-size: 12px; margin-top: 4px; }
    .result-line { color: var(--text-muted); font-size: 12px; }
    .summary { padding: 12px 16px; border-top: 1px solid var(--border); font-size: 13px; color: var(--text-muted); display: flex; gap: 16px; }
    .summary .count { font-weight: 600; }
    .summary .errors { color: #ef4444; }
    .summary .warnings { color: #f59e0b; }
    .summary .clean { color: #22c55e; }
    .examples { margin-top: 24px; }
    .examples h3 { font-size: 16px; font-weight: 600; margin-bottom: 12px; }
    .example-btns { display: flex; gap: 8px; flex-wrap: wrap; }
    .example-btn { background: var(--surface); border: 1px solid var(--border); border-radius: 6px; padding: 6px 14px; color: var(--text-muted); font-size: 13px; cursor: pointer; transition: all 0.15s; }
    .example-btn:hover { border-color: var(--accent); color: var(--text); }
    .cta-bar { margin-top: 32px; padding: 20px 24px; background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-lg); display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 16px; }
    .cta-bar p { color: var(--text-muted); font-size: 14px; margin: 0; }
    .cta-bar .code-block { font-size: 13px; }
    @media (max-width: 768px) {
      .playground-grid { grid-template-columns: 1fr; }
      .playground { padding: 80px 0 60px; }
    }
  </style>
</head>
<body>
  <nav class="nav">
    <div class="nav-inner">
      <a href="/" class="nav-logo">nedcodes</a>
      <div class="nav-links">
        <a href="/#tools">Tools</a>
        <a href="/guides/">Guides</a>
        <a href="/playground">Playground</a>
        <a href="https://github.com/nedcodes-ok" target="_blank" rel="noopener">GitHub</a>
      </div>
    </div>
  </nav>

  <main class="playground">
    <div class="container">
      <h1>Rule Playground</h1>
      <p class="sub">Paste a .mdc rule file and get instant feedback. No install needed.</p>

      <div class="playground-grid">
        <div class="editor-pane">
          <div class="pane-header">
            <span>Input</span>
            <span class="file-hint">.mdc format</span>
          </div>
          <textarea id="editor" spellcheck="false" placeholder="Paste your .mdc rule here...">---
description: TypeScript error handling in API routes
globs:
  - "src/api/**/*.ts"
  - "src/routes/**/*.ts"
---
Wrap all route handlers in try-catch blocks.

Return structured error responses:

```typescript
catch (error) {
  return Response.json(
    { error: error.message, code: "INTERNAL_ERROR" },
    { status: 500 }
  );
}
```

Never expose stack traces in production responses.
Log the full error with `console.error(error)` before returning.</textarea>
        </div>
        <div class="results-pane">
          <div class="pane-header">
            <span>Results</span>
            <span id="result-count" class="file-hint"></span>
          </div>
          <div class="results-body" id="results">
            <div class="result-item result-info">
              <span class="result-severity">tip</span>
              Paste a rule on the left to see diagnostics here.
            </div>
          </div>
          <div class="summary" id="summary" style="display:none;"></div>
        </div>
      </div>

      <div class="examples">
        <h2>Try an example</h2>
        <div class="example-btns">
          <button class="example-btn" onclick="loadExample('broken')">Broken frontmatter</button>
          <button class="example-btn" onclick="loadExample('vague')">Vague rules</button>
          <button class="example-btn" onclick="loadExample('conflict')">Self-conflicting</button>
          <button class="example-btn" onclick="loadExample('good')">Well-written rule</button>
          <button class="example-btn" onclick="loadExample('dead')">Dead rule</button>
          <button class="example-btn" onclick="loadExample('bloated')">Bloated rule</button>
        </div>
      </div>

      <div class="cta-bar">
        <p>Want to scan your entire project? Run the full CLI with 60+ checks, conflict detection, and auto-fix.</p>
        <div class="code-block">
          <code>npx cursor-doctor scan</code>
          <button class="copy-btn" onclick="copyCommand(this)" data-cmd="npx cursor-doctor scan" aria-label="Copy">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
          </button>
        </div>
      </div>
    </div>
  </main>

  <footer class="footer">
    <div class="container">
      <div class="footer-inner">
        <span class="footer-brand">nedcodes</span>
        <div class="footer-links">
          <a href="mailto:hello@nedcodes.dev">hello@nedcodes.dev</a>
          <a href="https://github.com/nedcodes-ok" target="_blank" rel="noopener">GitHub</a>
          <a href="https://dev.to/nedcodes" target="_blank" rel="noopener">Blog</a>
          <a href="https://nedcodes.gumroad.com" target="_blank" rel="noopener">Store</a>
        </div>
      </div>
    </div>
  </footer>

  <script>
  // AUTO-GENERATED by scripts/sync-playground.js — do not edit manually
  // Source: cursor-doctor/src/index.js
  // Last synced: 2026-02-28

  var VAGUE_PATTERNS = [
      "write clean code",
      "follow best practices",
      "be consistent",
      "write maintainable code",
      "handle errors properly",
      "use proper naming",
      "keep it simple",
      "write readable code",
      "follow conventions",
      "use good patterns",
      "write efficient code",
      "be careful",
      "think before coding",
      "write good tests",
      "follow solid principles",
      "use common sense",
      "write quality code",
      "follow the style guide",
      "be thorough",
      "write robust code",
      "use good naming",
      "be helpful",
      "use appropriate patterns",
      "be concise"
  ];

  var CONFLICT_PAIRS = [
      {
          "a": "always use semicolons",
          "b": "no semicolons",
          "subject": "semicolons"
      },
      {
          "a": "use single quotes",
          "b": "use double quotes",
          "subject": "quotes"
      },
      {
          "a": "prefer const",
          "b": "prefer let",
          "subject": "const vs let"
      },
      {
          "a": "use async/await",
          "b": "use promises",
          "subject": "async patterns"
      },
      {
          "a": "use function",
          "b": "use arrow function",
          "subject": "function syntax"
      }
  ];

  var VALID_KEYS = ["description","globs","alwaysApply"];

  var VAGUE_QUALIFIERS = ["with","for","in","by","using","and"];

  var IMPERATIVE_VERBS = /\\b(use|write|create|add|remove|ensure|check|validate|follow|apply|implement|wrap|handle|return|throw|test|run|call|import|export|set|define|configure|avoid|prefer|keep|split|merge|move|rename|update|delete|include|exclude|enable|disable)\\b/i;

  function parseFrontmatter(content) {
    content = content.replace(/\r\n/g, '\n').replace(/\r/g, '\n');
    var match = content.match(/^---\n([\s\S]*?)\n---/);
    if (!match) return { found: false, data: null, error: null };
    try {
      var data = {};
      var lines = match[1].split('\n');
      var currentKey = null, currentList = null;
      for (var i = 0; i < lines.length; i++) {
        var line = lines[i];
        if (line.match(/^\s+-\s+/)) {
          if (currentKey && currentList) {
            var val = line.replace(/^\s+-\s+/, '').trim();
            if (val.startsWith('"') && val.endsWith('"')) val = val.slice(1, -1);
            else if (val.startsWith("'") && val.endsWith("'")) val = val.slice(1, -1);
            currentList.push(val);
          }
          continue;
        }
        if (currentKey && currentList) { data[currentKey] = currentList; currentKey = null; currentList = null; }
        if (line.match(/^\s+\S/) && !line.match(/^\s+-/)) {
          var prev = i > 0 ? lines[i-1] : null;
          if (prev && !prev.endsWith(':')) return { found: true, data: null, error: 'Invalid YAML indentation' };
        }
        var ci = line.indexOf(':');
        if (ci === -1) continue;
        var key = line.slice(0, ci).trim();
        var rv = line.slice(ci + 1).trim();
        if (rv === '') { currentKey = key; currentList = []; }
        else if (rv === 'true') data[key] = true;
        else if (rv === 'false') data[key] = false;
        else if (rv.startsWith('"') && rv.endsWith('"')) data[key] = rv.slice(1, -1);
        else data[key] = rv;
      }
      if (currentKey && currentList) data[currentKey] = currentList;
      return { found: true, data: data, error: null };
    } catch (e) { return { found: true, data: null, error: e.message }; }
  }

  function getBody(content) {
    var m = content.match(/^---\n[\s\S]*?\n---\n?/);
    return m ? content.slice(m[0].length) : content;
  }

  function lint(content) {
    content = content.replace(/\r\n/g, '\n').replace(/\r/g, '\n');
    var issues = [];
    var fm = parseFrontmatter(content);
    var body = getBody(content);

    // --- Frontmatter checks ---
    if (!fm.found) {
      issues.push({ s:'error', m:'Missing YAML frontmatter', h:'Add --- block with description and alwaysApply fields' });
    } else if (fm.error) {
      issues.push({ s:'error', m:'YAML frontmatter error: '+fm.error, h:'Fix frontmatter indentation or syntax' });
    } else {
      var hasGlobs = fm.data.globs && (Array.isArray(fm.data.globs) ? fm.data.globs.length > 0 : fm.data.globs.trim().length > 0);

      if (fm.data.alwaysApply === undefined && !hasGlobs)
        issues.push({ s:'warning', m:'No alwaysApply or globs set', h:'Add alwaysApply: true for global rules, or add globs to scope to specific files' });

      var descEmpty = !fm.data.description || (typeof fm.data.description === 'string' && fm.data.description.trim() === '') || (Array.isArray(fm.data.description) && fm.data.description.length === 0);
      if (descEmpty)
        issues.push({ s:'warning', m:'Missing or empty description', h:'Add a description so Cursor knows when to apply this rule' });

      if (fm.data.alwaysApply === false && !hasGlobs)
        issues.push({ s:'error', m:'Rule will never load: alwaysApply is false and no globs set', h:'Set alwaysApply: true or add globs' });

      if (fm.data.description && typeof fm.data.description === 'string' && fm.data.description.trim().length > 0 && fm.data.description.trim().length < 10)
        issues.push({ s:'warning', m:'Description is very short (<10 chars)', h:'A longer description helps Cursor decide when to apply this rule' });

      if (fm.data.description && fm.data.description.length > 200)
        issues.push({ s:'warning', m:'Description is very long (>200 chars)', h:'Keep descriptions concise. Put details in the rule body.' });

      for (var key in fm.data) {
        if (VALID_KEYS.indexOf(key) === -1)
          issues.push({ s:'warning', m:'Unknown frontmatter key: '+key, h:'Valid keys: '+VALID_KEYS.join(', ') });
      }

      if (fm.data.description && /[*_`#\[\]]/.test(fm.data.description))
        issues.push({ s:'warning', m:'Description contains markdown formatting', h:'Descriptions should be plain text. Save formatting for the rule body.' });

      if (fm.data.globs && typeof fm.data.globs === 'string' && fm.data.globs.indexOf(',') !== -1 && !fm.data.globs.trim().startsWith('['))
        issues.push({ s:'warning', m:'Globs as comma-separated string', h:'Use YAML array format for cleaner syntax' });

      if (fm.data.alwaysApply === true && hasGlobs)
        issues.push({ s:'info', m:'alwaysApply is true with globs set', h:"When alwaysApply is true, globs are a hint to the model but don't filter" });
    }

    // --- Body checks ---
    if (fm.found && body.trim().length === 0)
      issues.push({ s:'error', m:'Rule has frontmatter but no instructions', h:'Add rule instructions after the --- block' });

    if (body.length > 5000)
      issues.push({ s:'error', m:'Rule body exceeds 5000 chars (~1250 tokens)', h:'Split into multiple focused rules' });
    else if (body.length > 2000)
      issues.push({ s:'warning', m:'Rule body is very long (>2000 chars)', h:'Consider splitting into focused rules' });

    if (body.length > 200 && !/```/.test(body) && !/\n {4,}\S/.test(body))
      issues.push({ s:'warning', m:'No code examples', h:'Rules with examples get followed more reliably' });

    // --- Vague rules (context-aware) ---
    var lines = content.split('\n');
    for (var vi = 0; vi < lines.length; vi++) {
      var ll = lines[vi].toLowerCase().trim();
      if (ll.startsWith('#') || ll.startsWith('```') || ll.length === 0) continue;
      for (var pi = 0; pi < VAGUE_PATTERNS.length; pi++) {
        var idx = ll.indexOf(VAGUE_PATTERNS[pi]);
        if (idx === -1) continue;
        var after = ll.slice(idx + VAGUE_PATTERNS[pi].length).trim();
        var qualified = false;
        for (var qi = 0; qi < VAGUE_QUALIFIERS.length; qi++) {
          if (after.startsWith(VAGUE_QUALIFIERS[qi] + ' ')) { qualified = true; break; }
        }
        if (qualified) continue;
        issues.push({ s:'warning', m:'Vague instruction: "'+VAGUE_PATTERNS[pi]+'"', h:'Be specific. What exactly should the AI do?', l:vi+1 });
        break;
      }
    }

    // --- Prompt engineering checks ---
    if (/\b(try to|maybe|consider|perhaps|possibly|might want to)\b/i.test(body))
      issues.push({ s:'warning', m:'Weak language detected (try to/maybe/consider)', h:'Use imperative mood: "Do X" instead of "try to do X"' });

    if (/\b(please|thank you|thanks)\b/i.test(body))
      issues.push({ s:'info', m:'Rule uses please/thank you', h:'Politeness wastes tokens. Be direct.' });

    if (/\b(I want|I need|I\'d like|my preference)\b/i.test(body))
      issues.push({ s:'info', m:'Rule uses first person', h:'Use direct commands: "Use X" instead of "I want you to use X"' });

    if (body.length > 100 && !IMPERATIVE_VERBS.test(body))
      issues.push({ s:'warning', m:'No clear actionable instructions', h:'Use imperative verbs: use, write, create, ensure, etc.' });

    // --- Negations without alternatives ---
    var negationMatches = body.match(/\b(don't|do not|never|avoid)\s+(?:use|do|write)\s+\w+/gi);
    if (negationMatches && negationMatches.length > 0) {
      if (!/instead|rather|prefer|use \w+ (?:rather|instead)/.test(body.toLowerCase()))
        issues.push({ s:'warning', m:'Rule uses negations without alternatives', h:"Instead of \"don't use X\", say \"use Y instead of X\"" });
    }

    // --- Self-conflict check ---
    var bl = body.toLowerCase();
    for (var ci = 0; ci < CONFLICT_PAIRS.length; ci++) {
      if (bl.indexOf(CONFLICT_PAIRS[ci].a) !== -1 && bl.indexOf(CONFLICT_PAIRS[ci].b) !== -1)
        issues.push({ s:'error', m:'Conflicting instructions about '+CONFLICT_PAIRS[ci].subject, h:'Choose one approach' });
    }

    // --- Structural checks ---
    if (/\n\n\n\n/.test(body))
      issues.push({ s:'info', m:'Excessive blank lines (>3 consecutive)', h:'Excessive whitespace wastes tokens' });

    if (/\b(TODO|FIXME|HACK|XXX)\b/.test(body))
      issues.push({ s:'warning', m:'Contains TODO/FIXME/HACK comments', h:'Unfinished rules confuse the model. Finish or remove.' });

    if (fm.data && fm.data.description && typeof fm.data.description === 'string' && fm.data.description.trim().length > 0 && body.trim().startsWith(fm.data.description))
      issues.push({ s:'warning', m:'Body starts with description repeated', h:'Redundant content wastes tokens' });

    // --- XML/HTML tags ---
    if (/<[^>]+>/.test(body) && !/```/.test(body)) {
      var xmlTags = body.match(/<\w+[^>]*>/g);
      if (xmlTags && xmlTags.length > 0)
        issues.push({ s:'warning', m:'Rule body contains XML/HTML tags', h:"Cursor doesn't process XML/HTML in rules. Use markdown or plain text." });
    }

    // --- Broken markdown links ---
    if (/\]\[/.test(body) || /\[[^\]]*\]\([^)]*$/.test(body))
      issues.push({ s:'warning', m:'Rule body has broken markdown links', h:'Fix link syntax: [text](url)' });

    // --- Inconsistent heading levels ---
    var headings = body.match(/^#{1,6}\s+.+/gm);
    if (headings && headings.length >= 2) {
      var levels = headings.map(function(h) { return h.match(/^#+/)[0].length; });
      var hasSkip = false;
      for (var hi = 1; hi < levels.length; hi++) {
        if (levels[hi] > levels[0] + 1 && levels[hi - 1] < levels[hi] - 1) { hasSkip = true; break; }
      }
      if (hasSkip) issues.push({ s:'warning', m:'Inconsistent heading levels (jumps from # to ###)', h:'Use consistent heading hierarchy' });
    }

    // --- Body is just a URL ---
    var bodyTrimmed = body.trim();
    if (/^https?:\/\//.test(bodyTrimmed)) {
      var bodyLines = bodyTrimmed.split('\n').filter(function(l) { return l.trim().length > 0; });
      var nonUrlLines = bodyLines.filter(function(l) { return !/^https?:\/\//.test(l.trim()); });
      if (nonUrlLines.length < 2)
        issues.push({ s:'warning', m:'Rule body appears to be just a URL', h:'Cursor cannot follow URLs. Put the actual instructions in the rule body.' });
    }

    // --- Mixed concerns ---
    var concernKeywords = {
      testing: /\b(test|spec|jest|mocha|vitest|cypress|playwright)\b/i,
      styling: /\b(css|style|styled|tailwind|emotion|sass|less)\b/i,
      naming: /\b(naming|name|identifier|variable name|function name)\b/i,
      types: /\b(type|interface|generic|typescript|type safety)\b/i,
      architecture: /\b(architecture|structure|organization|folder|directory)\b/i
    };
    var matchedConcerns = [];
    for (var ck in concernKeywords) {
      if (concernKeywords[ck].test(body)) matchedConcerns.push(ck);
    }
    if (matchedConcerns.length >= 3)
      issues.push({ s:'warning', m:'Rule mixes multiple concerns: '+matchedConcerns.join(', '), h:'Rules that cover too many topics are harder for the AI to apply. Split into focused rules.' });

    // --- Numbered lists where order doesn't matter ---
    var numberedLists = body.match(/\n\d+\.\s+/g);
    if (numberedLists && numberedLists.length >= 5) {
      if (!/\b(first|second|third|then|next|finally|after|before)\b/i.test(body))
        issues.push({ s:'info', m:'Numbered lists where order may not matter', h:'Bullet lists are more flexible when order is unimportant.' });
    }

    // --- Glob checks (playground-safe subset) ---
    if (fm.data && fm.data.globs) {
      var globs = [];
      if (typeof fm.data.globs === 'string') {
        var gt = fm.data.globs.trim();
        if (gt.startsWith('[')) globs = gt.slice(1,-1).split(',').map(function(g){return g.trim().replace(/^["']|["']$/g,'');}).filter(Boolean);
        else globs = gt.split(',').map(function(g){return g.trim().replace(/^["']|["']$/g,'');}).filter(Boolean);
      } else if (Array.isArray(fm.data.globs)) globs = fm.data.globs;

      for (var gi = 0; gi < globs.length; gi++) {
        var glob = globs[gi];
        if (glob === '*' || glob === '**')
          issues.push({ s:'warning', m:'Overly broad glob pattern', h:'This matches everything. Use more specific patterns or alwaysApply: true.' });
        if (glob.indexOf('\\') !== -1)
          issues.push({ s:'warning', m:'Glob uses Windows backslashes: '+glob, h:'Use forward slashes for cross-platform compatibility.' });
        if (glob.endsWith('/'))
          issues.push({ s:'warning', m:'Glob has trailing slash: '+glob, h:'Trailing slashes are not valid glob syntax.' });
        if (glob.startsWith('./'))
          issues.push({ s:'info', m:'Glob starts with ./: '+glob, h:'Cursor resolves from project root. The ./ prefix is unnecessary.' });
        if (glob === '*.')
          issues.push({ s:'warning', m:'Glob has no file extension after dot', h:'Add an extension: *.ts, *.js, etc.' });
        if (glob.indexOf(' ') !== -1)
          issues.push({ s:'warning', m:'Glob pattern contains spaces', h:'Glob patterns with spaces may not match correctly.' });
      }
    }

    return issues;
  }

  function render(issues) {
    var el = document.getElementById('results');
    var sum = document.getElementById('summary');
    var cnt = document.getElementById('result-count');

    if (issues.length === 0) {
      el.innerHTML = '<div class="result-item result-ok"><span class="result-severity">pass</span> No issues found. This rule looks good.</div>';
      sum.style.display = 'flex';
      sum.innerHTML = '<span class="clean count">\u2713 Clean</span>';
      cnt.textContent = '0 issues';
      return;
    }

    var errors = 0, warnings = 0, infos = 0;
    var html = '';
    for (var i = 0; i < issues.length; i++) {
      var iss = issues[i];
      var cls = iss.s === 'error' ? 'result-error' : iss.s === 'warning' ? 'result-warning' : 'result-info';
      if (iss.s === 'error') errors++;
      else if (iss.s === 'warning') warnings++;
      else infos++;
      html += '<div class="result-item '+cls+'">';
      html += '<span class="result-severity">'+iss.s+'</span>';
      if (iss.l) html += '<span class="result-line">Line '+iss.l+': </span>';
      html += iss.m;
      if (iss.h) html += '<div class="result-hint">'+iss.h+'</div>';
      html += '</div>';
    }
    el.innerHTML = html;
    cnt.textContent = issues.length + ' issue' + (issues.length === 1 ? '' : 's');

    var parts = [];
    if (errors) parts.push('<span class="errors count">'+errors+' error'+(errors===1?'':'s')+'</span>');
    if (warnings) parts.push('<span class="warnings count">'+warnings+' warning'+(warnings===1?'':'s')+'</span>');
    if (infos) parts.push('<span class="count">'+infos+' info</span>');
    sum.style.display = 'flex';
    sum.innerHTML = parts.join('');
  }

  var EXAMPLES = {
    broken: '---\ndescription\nalwaysApply true\n---\nUse TypeScript strict mode.',
    vague: '---\ndescription: General coding rules\nalwaysApply: true\n---\nWrite clean code.\nFollow best practices.\nBe consistent.\nHandle errors properly.',
    conflict: '---\ndescription: Style rules\nalwaysApply: true\n---\nAlways use semicolons at the end of every statement.\n\nAvoid semicolons. No semicolons in this project.',
    good: '---\ndescription: TypeScript error handling in API routes\nglobs:\n  - "src/api/**/*.ts"\n  - "src/routes/**/*.ts"\n---\nWrap all route handlers in try-catch blocks.\n\nReturn structured error responses:\n\n```typescript\ncatch (error) {\n  return Response.json(\n    { error: error.message, code: "INTERNAL_ERROR" },\n    { status: 500 }\n  );\n}\n```\n\nNever expose stack traces in production responses.\nLog the full error with `console.error(error)` before returning.',
    dead: '---\ndescription: Python formatting\nalwaysApply: false\n---\nUse black for formatting.\nLine length 88 characters.',
    bloated: '---\ndescription: Everything about our codebase\nalwaysApply: true\n---\n' + Array(201).join('This rule covers everything.\n') + '\nPlease try to maybe follow these guidelines.\nI want you to be careful.\nTODO: finish this rule later.'
  };

  function loadExample(name) {
    document.getElementById('editor').value = EXAMPLES[name];
    run();
  }

  function run() {
    var content = document.getElementById('editor').value;
    if (!content.trim()) {
      document.getElementById('results').innerHTML = '<div class="result-item result-info"><span class="result-severity">tip</span> Paste a rule on the left to see diagnostics here.</div>';
      document.getElementById('summary').style.display = 'none';
      document.getElementById('result-count').textContent = '';
      return;
    }
    render(lint(content));
  }

  document.getElementById('editor').addEventListener('input', run);
  run(); // Lint the pre-filled example on page load

  function copyCommand(btn) {
    var cmd = btn.getAttribute('data-cmd');
    navigator.clipboard.writeText(cmd).then(function() {
      btn.classList.add('copied');
      setTimeout(function() { btn.classList.remove('copied'); }, 1500);
    });
  }
  </script>
</body>
</html>
